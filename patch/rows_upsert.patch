diff --git b/R/rows_upsert.R a/R/rows_upsert.R
index fff23fa6..01edf634 100644
--- b/R/rows_upsert.R
+++ a/R/rows_upsert.R
@@ -2,7 +2,7 @@
 #' @export
 rows_upsert.duckplyr_df <- function(x, y, by = NULL, ..., copy = FALSE, in_place = FALSE) {
   # Our implementation
-  rel_try(
+  rel_try(NULL,
     "No relational implementation for rows_upsert()" = TRUE,
     {
       return(out)
@@ -56,7 +56,7 @@ rows_upsert.duckplyr_df <- function(x, y, by = NULL, ..., copy = FALSE, in_place
 
   # Insert
   y_size <- vec_size(y_key)
-  y_extra <- vec_as_location_invert(y_loc, y_size)
+  y_extra <- dplyr$vec_as_location_invert(y_loc, y_size)
 
   y <- dplyr_row_slice(y, y_extra)
   y <- rows_cast_y(y, x)
